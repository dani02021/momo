<% for(i in session.dataValues.messages) { %>
  <% if(session.dataValues.messages.hasOwnProperty(i)) { %>
    <% if(i=='userEdited' ) { %>
      <div class="alert alert-warning alert-dismissible fade show" role="alert">
        <strong>
          <%= session.dataValues.messages[i] %>
        </strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      <% } %>
        <% } %>
          <% } %>
            <form action="" method="post">
              <div class="container tm-mt-big tm-mb-big">
                <div class="tm-bg-primary-dark tm-block tm-block-h-auto">
                  <input type="hidden" name="type" value="payment">
                  <div class="row mt-2">
                    <div class="col mx-auto d-flex justify-content-center">
                      <label style="color: white;">E-Mail Payment Template</label>
                    </div>
                  </div>
                  <div class="row mt-3">
                    <div class="col mx-auto d-flex justify-content-center">
                      <input name="text" name="subject" , placeholder="Subject">
                    </div>
                  </div>
                  <div class="row mt-3">
                    <div class="col mx-auto d-flex justify-content-center">
                      <textarea name="uppercontent" style="min-height: 300px; width: 100%;" cols="30" rows="10"
                        placeholder="Upper Content"></textarea>
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col mx-auto d-flex justify-content-center">
                      <label style="color: white;">Table:</label>
                    </div>
                  </div>
                  <div class="row mt-3">
                    <div class="col mx-auto">
                      <div class="row justify-content-between">
                        <div class="col d-flex justify-content-center">
                          <select name="table" onchange="setTableCol(this, 0)">
                            <option value="-" selected>-</option>
                            <option value="username">Username</option>
                            <option value="quantity">Quantity</option>
                            <option value="price">Price</option>
                            <option value="subtotal">SubTotal</option>
                          </select>
                        </div>
                        <div class="col d-flex justify-content-center">
                          <select name="table" onchange="setTableCol(this, 1)">
                            <option value="-" selected>-</option>
                            <option value="username">Username</option>
                            <option value="quantity">Quantity</option>
                            <option value="price">Price</option>
                            <option value="subtotal">SubTotal</option>
                          </select>
                        </div>
                        <div class="col d-flex justify-content-center">
                          <select name="table" onchange="setTableCol(this, 2)">
                            <option value="-" selected>-</option>
                            <option value="username">Username</option>
                            <option value="quantity">Quantity</option>
                            <option value="price">Price</option>
                            <option value="subtotal">SubTotal</option>
                          </select>
                        </div>
                        <div class="col d-flex justify-content-center">
                          <select name="table" onchange="setTableCol(this, 3)">
                            <option value="-" selected>-</option>
                            <option value="username">Username</option>
                            <option value="quantity">Quantity</option>
                            <option value="price">Price</option>
                            <option value="subtotal">SubTotal</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row mt-3">
                    <div class="col mx-auto d-flex justify-content-center">
                      <textarea name="lowercontent" style="min-height: 300px; width: 100%;" cols="30" rows="10"
                        placeholder="Lower Content"></textarea>
                    </div>
                  </div>
                  <div class="row mt-3">
                    <div class="col mx-auto d-flex justify-content-center">
                      <button type="submit" class="btn btn-primary btn-block">Submit</button>
                    </div>
                  </div>
                </div>
              </div>
            </form>
            <script>
              let cols = [];
              let disabled = [];

              function setTableCol(elem, num) {
                if (!cols[parseInt(num)]) {
                  cols[parseInt(num)] = elem.value;

                  disabled = disabled.filter(item => item !== elem.value);

                  if (elem.value !== '-') {
                    disabled.push(elem.value);

                    let selects = elem.parentElement.parentElement.getElementsByTagName("select");

                    for (i = 0; i < selects.length; i++) {
                      let options = selects[i].options;

                      for (z = 0; z < options.length; z++) {
                        if (disabled.includes(options[z].value))
                          options[z].disabled = true;
                      }
                    }
                  }
                } else 
                {
                  let selects = elem.parentElement.parentElement.getElementsByTagName("select");

                  for (i = 0; i < selects.length; i++) {
                      let options = selects[i].options;

                      for (z = 0; z < options.length; z++) {
                        if (disabled.includes(cols[parseInt(num)]))
                          options[z].disabled = false;
                      }
                    }

                    if (elem.value !== '-')
                      disabled.push(elem.value);

                    disabled = disabled.filter(item => item !== cols[parseInt(num)]);

                    for (i = 0; i < selects.length; i++) {
                      let options = selects[i].options;

                      for (z = 0; z < options.length; z++) {
                        if (disabled.includes(options[z].value))
                          options[z].disabled = true;
                      }
                    }

                    cols[parseInt(num)] = elem.value;
                }
              }
            </script>